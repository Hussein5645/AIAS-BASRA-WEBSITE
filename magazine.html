<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magazine - AIAS Basra Chapter</title>
    <link rel="icon" type="image/png" href="static/images/branding/LOGO.png">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Authentication Check -->
    <script type="module" src="js/auth.js"></script>
    <!-- PDF.js Library for PDF thumbnails and book mode -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // Configure PDF.js worker
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        } else {
            console.warn('[PDF] PDF.js library not loaded - book mode and thumbnails will not work');
        }
    </script>
    <style>
        .magazine-hero {
            background: var(--gradient-1);
            color: var(--white);
            padding: 8rem 0 4rem;
            text-align: center;
        }
        
        .magazine-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .featured-article {
            padding: 5rem 0;
            background: var(--light-bg);
        }
        
        .featured-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
        }
        
        .featured-image {
            height: 400px;
            background: var(--gradient-2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6rem;
            box-shadow: var(--shadow-lg);
        }
        
        .featured-text h2 {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .article-date {
            color: var(--accent-color);
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .featured-text p {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }
        
        .articles-section {
            padding: 5rem 0;
        }
        
        .view-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            background: var(--light-bg);
            padding: 0.5rem;
            border-radius: 8px;
        }
        
        .view-btn {
            padding: 0.75rem 1.25rem;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }
        
        .view-btn span {
            font-size: 1.1rem;
        }
        
        .view-btn:hover {
            background: var(--white);
            color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .view-btn.active {
            background: var(--gradient-1);
            color: var(--white);
            box-shadow: var(--shadow-sm);
        }
        
        .view-btn.active:hover {
            transform: scale(1.05);
        }
        
        .articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            transition: all 0.3s ease;
        }
        
        /* Grid View (Default) */
        .articles-grid.view-grid {
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        }
        
        /* List View */
        .articles-grid.view-list {
            grid-template-columns: 1fr;
        }
        
        .articles-grid.view-list .article-card {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 0;
        }
        
        .articles-grid.view-list .article-image {
            height: 100%;
            min-height: 200px;
        }
        
        .articles-grid.view-list .article-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        /* Compact Grid View */
        .articles-grid.view-compact {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .articles-grid.view-compact .article-card {
            font-size: 0.9rem;
        }
        
        .articles-grid.view-compact .article-image {
            height: 160px;
            font-size: 3rem;
        }
        
        .articles-grid.view-compact .article-content {
            padding: 1rem;
        }
        
        .articles-grid.view-compact .article-title {
            font-size: 1.1rem;
        }
        
        .articles-grid.view-compact .article-excerpt {
            font-size: 0.85rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Large Grid View */
        .articles-grid.view-large {
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 3rem;
        }
        
        .articles-grid.view-large .article-image {
            height: 280px;
            font-size: 5rem;
        }
        
        .articles-grid.view-large .article-content {
            padding: 2rem;
        }
        
        .articles-grid.view-large .article-title {
            font-size: 1.5rem;
        }
        
        .article-card {
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: all 0.4s ease;
            cursor: pointer;
            perspective: 1000px;
        }
        
        .article-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-xl);
        }
        
        .article-image {
            height: 220px;
            background: var(--gradient-2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            position: relative;
            overflow: hidden;
        }
        
        .article-image::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.3) 100%);
        }
        
        .article-category {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: var(--white);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--primary-color);
            z-index: 1;
        }
        
        .article-content {
            padding: 1.5rem;
        }
        
        .article-meta {
            display: flex;
            gap: 1rem;
            color: var(--text-light);
            font-size: 0.85rem;
            margin-bottom: 1rem;
        }
        
        .article-title {
            font-size: 1.25rem;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
            font-weight: 600;
            line-height: 1.4;
        }
        
        .article-excerpt {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }
        
        .read-more {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-color);
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .read-more:hover {
            gap: 1rem;
        }
        
        .magazine-releases {
            padding: 5rem 0;
            background: var(--white);
        }
        
        .releases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }
        
        .release-card {
            background: var(--white);
            border: 2px solid var(--light-bg);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .release-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-color);
        }
        
        .release-preview {
            background: var(--gradient-1);
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            color: var(--white);
            position: relative;
            overflow: hidden;
        }
        
        .release-preview canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .release-preview .pdf-thumbnail {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #f0f0f0;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        
        .release-preview .loading-indicator {
            position: absolute;
            font-size: 2rem;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .release-preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.3) 100%);
            z-index: 1;
        }
        
        .release-info {
            padding: 1.5rem;
        }
        
        .release-title {
            font-size: 1.25rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-weight: 700;
        }
        
        .release-date {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        .release-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .release-btn {
            flex: 1;
            min-width: 120px;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .btn-view {
            background: var(--gradient-1);
            color: var(--white);
        }
        
        .btn-view:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }
        
        .btn-download {
            background: var(--white);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }
        
        .btn-download:hover {
            background: var(--primary-color);
            color: var(--white);
        }
        
        .empty-releases {
            text-align: center;
            padding: 4rem 2rem;
            background: var(--light-bg);
            border-radius: 12px;
        }
        
        .empty-releases-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }
        
        .empty-releases h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .empty-releases p {
            color: var(--text-secondary);
        }
        
        /* PDF Viewer Modal */
        .pdf-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            overflow: hidden;
        }
        
        .pdf-modal.active {
            display: flex;
            flex-direction: column;
        }
        
        .pdf-modal-header {
            background: var(--primary-color);
            color: var(--white);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .pdf-modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .pdf-modal-close {
            background: none;
            border: none;
            color: var(--white);
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .pdf-modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .pdf-modal-content {
            flex: 1;
            overflow: hidden;
            position: relative;
            background: #525659;
        }
        
        .pdf-viewer-iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: #fff;
        }
        
        .pdf-viewer-embed {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .pdf-viewer-object {
            width: 100%;
            height: 100%;
        }
        
        .pdf-fallback {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--white);
            text-align: center;
            padding: 2rem;
        }
        
        .pdf-fallback h3 {
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .pdf-fallback p {
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }
        
        .pdf-fallback .btn {
            margin: 0.5rem;
        }
        
        /* Book Mode Styles */
        .pdf-book-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #2d3436;
        }
        
        .pdf-book-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background: #1a1d1f;
            border-bottom: 2px solid #404448;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .pdf-book-nav {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .pdf-book-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
        }
        
        .pdf-book-btn:hover:not(:disabled) {
            background: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .pdf-book-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .pdf-book-btn.btn-icon {
            padding: 0.6rem;
            min-width: 40px;
            justify-content: center;
        }
        
        .pdf-page-info {
            color: white;
            font-weight: 600;
            font-size: 0.95rem;
            padding: 0.6rem 1.2rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            white-space: nowrap;
        }
        
        .pdf-page-jump {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .pdf-page-jump input {
            width: 60px;
            padding: 0.5rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 4px;
            text-align: center;
            font-weight: 600;
        }
        
        .pdf-page-jump input:focus {
            outline: none;
            border-color: var(--accent-color);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .pdf-view-toggle {
            display: flex;
            gap: 0.5rem;
        }
        
        .pdf-view-toggle .pdf-book-btn {
            padding: 0.6rem 1rem;
        }
        
        .pdf-view-toggle .pdf-book-btn.active {
            background: var(--primary-color);
        }
        
        .pdf-layout-toggle {
            display: flex;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.3rem;
            border-radius: 6px;
        }
        
        .pdf-layout-btn {
            background: transparent;
            color: white;
            border: none;
            padding: 0.5rem 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .pdf-layout-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .pdf-layout-btn.active {
            background: var(--accent-color);
        }
        
        .pdf-zoom-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .pdf-zoom-level {
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            min-width: 50px;
            text-align: center;
        }
        
        .pdf-book-viewer {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            overflow: auto;
            position: relative;
            min-height: 0;
        }
        
        .pdf-book-spread {
            display: flex;
            gap: 2rem;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            transform-origin: center center;
        }
        
        .pdf-book-spread.single-page {
            gap: 0;
        }
        
        .pdf-book-page {
            background: white;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5),
                        0 0 20px rgba(0, 0, 0, 0.3),
                        inset 0 0 0 1px rgba(0, 0, 0, 0.1);
            border-radius: 2px;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
            max-height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .pdf-book-page canvas {
            display: block;
            max-width: 100%;
            max-height: 100%;
            border-radius: 2px;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        
        .pdf-book-page-left {
            transform-origin: right center;
        }
        
        .pdf-book-page-right {
            transform-origin: left center;
        }
        
        .pdf-book-page-single {
            margin: 0 auto;
        }
        
        .pdf-loading {
            color: white;
            font-size: 1.2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            text-align: center;
        }
        
        .pdf-loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        /* Page turn animations */
        .pdf-book-page.turning-next-left {
            animation: turnPageNextLeft 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        .pdf-book-page.turning-next-right {
            animation: turnPageNextRight 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        .pdf-book-page.turning-prev-left {
            animation: turnPagePrevLeft 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        .pdf-book-page.turning-prev-right {
            animation: turnPagePrevRight 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        @keyframes turnPageNextLeft {
            0% { transform: rotateY(0deg); opacity: 1; }
            50% { transform: rotateY(-90deg); opacity: 0.7; }
            100% { transform: rotateY(0deg); opacity: 1; }
        }
        
        @keyframes turnPageNextRight {
            0% { transform: rotateY(0deg); opacity: 1; }
            50% { transform: rotateY(90deg); opacity: 0.7; }
            100% { transform: rotateY(0deg); opacity: 1; }
        }
        
        @keyframes turnPagePrevLeft {
            0% { transform: rotateY(0deg); opacity: 1; }
            50% { transform: rotateY(90deg); opacity: 0.7; }
            100% { transform: rotateY(0deg); opacity: 1; }
        }
        
        @keyframes turnPagePrevRight {
            0% { transform: rotateY(0deg); opacity: 1; }
            50% { transform: rotateY(-90deg); opacity: 0.7; }
            100% { transform: rotateY(0deg); opacity: 1; }
        }
        
        /* Fullscreen mode */
        .pdf-book-container.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10001;
        }
        
        @media (max-width: 768px) {
            .magazine-hero h1 {
                font-size: 2rem;
            }
            
            .featured-content {
                grid-template-columns: 1fr;
            }
            
            .releases-grid {
                grid-template-columns: 1fr;
            }
            
            .release-actions {
                flex-direction: column;
            }
            
            .release-btn {
                width: 100%;
            }
            
            .view-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .view-toggle {
                width: 100%;
                justify-content: center;
            }
            
            .articles-grid.view-list .article-card {
                grid-template-columns: 1fr;
            }
            
            .articles-grid.view-list .article-image {
                height: 200px;
            }
            
            .articles-grid.view-large {
                grid-template-columns: 1fr;
            }
            
            .pdf-book-spread {
                gap: 1rem;
            }
            
            .pdf-book-controls {
                padding: 0.75rem 1rem;
                gap: 0.75rem;
            }
            
            .pdf-book-nav {
                width: 100%;
                justify-content: center;
                gap: 0.5rem;
            }
            
            .pdf-book-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.85rem;
            }
            
            .pdf-book-btn span {
                display: none;
            }
            
            .pdf-book-btn.btn-icon span {
                display: inline;
            }
            
            .pdf-page-info {
                font-size: 0.85rem;
                padding: 0.5rem 0.8rem;
            }
            
            .pdf-layout-toggle {
                width: 100%;
                justify-content: center;
            }
            
            .pdf-zoom-controls {
                width: 100%;
                justify-content: center;
            }
            
            .pdf-book-viewer {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="container">
            <div class="nav-content">
                <div class="logo">
                    <img src="static/images/branding/LOGO.png" alt="AIAS Basra Logo">
                    <span>AIAS Basra</span>
                </div>
                <button class="menu-toggle" id="menuToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="nav-links" id="navLinks">
                    <li><a href="index.html" data-en="Home" data-ar="ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©">Home</a></li>
                    <li><a href="events.html" data-en="Events" data-ar="ÿßŸÑŸÅÿπÿßŸÑŸäÿßÿ™">Events</a></li>
                    <li><a href="education.html" data-en="Education" data-ar="ÿßŸÑÿ™ÿπŸÑŸäŸÖ">Education</a></li>
                    <li><a href="magazine.html" class="active" data-en="Magazine" data-ar="ÿßŸÑŸÖÿ¨ŸÑÿ©">Magazine</a></li>
                    <li><a href="library.html" data-en="Library" data-ar="ÿßŸÑŸÖŸÉÿ™ÿ®ÿ©">Library</a></li>
                    <li><a href="about.html" data-en="About Us" data-ar="ŸÖŸÜ ŸÜÿ≠ŸÜ">About Us</a></li>
                    <li>
                        <button class="language-toggle" id="languageToggle">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                            </svg>
                            <span id="currentLang">EN</span>
                        </button>
                    </li>
                    <li id="dashboardBtn" style="display: none;"><a href="admin-dashboard.html" class="nav-btn nav-btn-signup" data-en="Dashboard" data-ar="ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ">Dashboard</a></li>
                    <li id="loginBtn"><a href="login.html" class="nav-btn nav-btn-login" data-en="Login" data-ar="ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ">Login</a></li>
                    <li id="signupBtn"><a href="signup.html" class="nav-btn nav-btn-signup" data-en="Sign Up" data-ar="ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®">Sign Up</a></li>
                    <li id="userProfile" style="display: none;">
                        <span id="userName" style="color: #667eea; font-weight: 600; margin-right: 10px;"></span>
                        <a href="#" id="logoutBtn" class="nav-btn nav-btn-login" data-en="Logout" data-ar="ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Magazine Hero -->
    <section class="magazine-hero">
        <div class="container">
            <h1 class="fade-in-up" data-en="Magazine & Articles" data-ar="ÿßŸÑŸÖÿ¨ŸÑÿ© ŸàÿßŸÑŸÖŸÇÿßŸÑÿßÿ™">Magazine & Articles</h1>
            <p class="fade-in-up delay-1" data-en="Explore insights, trends, and stories from the world of architecture" data-ar="ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ÿßŸÑÿ£ŸÅŸÉÿßÿ± ŸàÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™ ŸàÿßŸÑŸÇÿµÿµ ŸÖŸÜ ÿπÿßŸÑŸÖ ÿßŸÑŸáŸÜÿØÿ≥ÿ© ÿßŸÑŸÖÿπŸÖÿßÿ±Ÿäÿ©">Explore insights, trends, and stories from the world of architecture</p>
        </div>
    </section>



    <!-- Magazine Releases -->
    <section class="magazine-releases">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title" data-en="Magazine Releases" data-ar="ÿ•ÿµÿØÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ¨ŸÑÿ©">Magazine Releases</h2>
                <p class="section-subtitle" data-en="Download and read our latest magazine issues" data-ar="ÿ≠ŸÖŸÑ ŸàÿßŸÇÿ±ÿ£ ÿ£ÿ≠ÿØÿ´ ÿ•ÿµÿØÿßÿ±ÿßÿ™ ŸÖÿ¨ŸÑÿ™ŸÜÿß">Download and read our latest magazine issues</p>
            </div>
            <div class="releases-grid" id="releasesGrid">
                <!-- Magazine releases will be loaded here -->
                <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">‚è≥</div>
                    <p style="color: var(--text-secondary);">Loading magazine releases...</p>
                </div>
            </div>
        </div>
    </section>


    <!-- All Articles Section -->
    <section class="articles-section" style="background: var(--light-bg);">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title" data-en="All Articles" data-ar="ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸÇÿßŸÑÿßÿ™">All Articles</h2>
                <p class="section-subtitle" data-en="Browse our complete collection of articles" data-ar="ÿ™ÿµŸÅÿ≠ ŸÖÿ¨ŸÖŸàÿπÿ™ŸÜÿß ÿßŸÑŸÉÿßŸÖŸÑÿ© ŸÖŸÜ ÿßŸÑŸÖŸÇÿßŸÑÿßÿ™">Browse our complete collection of articles</p>
            </div>
            <div class="view-controls">
                <div></div>
                <div class="view-toggle">
                    <button class="view-btn active" data-view="grid" data-target="allArticles">
                        <span>‚ñ¶</span> Grid
                    </button>
                    <button class="view-btn" data-view="list" data-target="allArticles">
                        <span>‚ò∞</span> List
                    </button>
                    <button class="view-btn" data-view="compact" data-target="allArticles">
                        <span>‚ñ™</span> Compact
                    </button>
                </div>
            </div>
            <div class="articles-grid view-grid" id="allArticles">
                <!-- All articles will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>AIAS Basra Chapter</h3>
                    <p>American Institute of Architecture Students - Basra Chapter</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="events.html">Events</a></li>
                        <li><a href="library.html">Library</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Us</h4>
                    <p style="margin-bottom: 0.5rem;">
                        <a href="mailto:basrah@aias.org" style="color: inherit; text-decoration: none;">
                            üìß basrah@aias.org
                        </a>
                    </p>
                    <p style="margin-bottom: 0.5rem;">
                        <a href="https://instagram.com/aias.bsr" target="_blank" rel="noopener noreferrer" style="color: inherit; text-decoration: none;">
                            üì∑ Instagram: @aias.bsr
                        </a>
                    </p>
                    <p style="margin-bottom: 0.5rem;">
                        <a href="https://x.com/aiasbasra" target="_blank" rel="noopener noreferrer" style="color: inherit; text-decoration: none;">
                            ùïè X: @aiasbasra
                        </a>
                    </p>
                    <p style="margin-bottom: 0.5rem;">
                        <a href="https://www.tiktok.com/@aiasbsr" target="_blank" rel="noopener noreferrer" style="color: inherit; text-decoration: none;">
                            üéµ TikTok: @aiasbsr
                        </a>
                    </p>
                    <p style="margin-bottom: 1rem;">
                        <a href="https://www.facebook.com/share/19mEUHcFQs/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer" style="color: inherit; text-decoration: none;">
                            üìò Facebook
                        </a>
                    </p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 AIAS Basra Chapter. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- PDF Viewer Modal -->
    <div class="pdf-modal" id="pdfModal">
        <div class="pdf-modal-header">
            <div class="pdf-modal-title" id="pdfModalTitle">Magazine Preview</div>
            <div class="pdf-view-toggle" id="pdfViewToggle" style="display: none;">
                <button class="pdf-book-btn" id="normalViewBtn" title="Normal View">
                    üìÑ Normal
                </button>
                <button class="pdf-book-btn active" id="bookViewBtn" title="Book View">
                    üìñ Book Mode
                </button>
            </div>
            <button class="pdf-modal-close" id="pdfModalClose" aria-label="Close">&times;</button>
        </div>
        <div class="pdf-modal-content">
            <!-- PDF content will be loaded here dynamically -->
        </div>
    </div>

    <script src="js/three-effects.js"></script>
    <script src="js/main.js"></script>
    <script type="module">
        // Import Data Loader and Categories Loader
        import dataLoader from "./js/data-loader.js";
        import categoriesLoader from "./js/categories-loader.js";

        // Debug toggle: enable via ?debug=true or localStorage.setItem('debug','true')
        const DEBUG =
          (new URLSearchParams(window.location.search).has('debug') ||
           localStorage.getItem('debug') === 'true');

        // Magazine releases configuration
        const RELEASES_FOLDER = 'static/magazine-releases/';
        
        // PDF Modal functionality with Book Mode
        function initPDFModal() {
            const modal = document.getElementById('pdfModal');
            const closeBtn = document.getElementById('pdfModalClose');
            const modalContent = document.querySelector('.pdf-modal-content');
            const viewToggle = document.getElementById('pdfViewToggle');
            const normalViewBtn = document.getElementById('normalViewBtn');
            const bookViewBtn = document.getElementById('bookViewBtn');
            
            let currentPdfUrl = '';
            let currentTitle = '';
            let currentViewMode = 'book'; // default to book mode
            let pdfDocument = null;
            let currentPage = 1;
            let totalPages = 0;
            
            // Open PDF Viewer
            window.openPDFViewer = function(pdfUrl, title) {
                console.log('[PDF Viewer] Opening PDF:', pdfUrl);
                currentPdfUrl = pdfUrl;
                currentTitle = title;
                
                document.getElementById('pdfModalTitle').textContent = title;
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                viewToggle.style.display = 'flex';
                
                // Load in book mode by default
                loadBookMode();
            };
            
            // Close PDF Viewer
            window.closePDFViewer = function() {
                modal.classList.remove('active');
                modalContent.innerHTML = '';
                document.body.style.overflow = '';
                viewToggle.style.display = 'none';
                pdfDocument = null;
                currentPage = 1;
                totalPages = 0;
            };
            
            // Switch to Normal View
            function loadNormalView() {
                currentViewMode = 'normal';
                normalViewBtn.classList.add('active');
                bookViewBtn.classList.remove('active');
                
                // Ensure URL is absolute
                let fullPdfUrl = currentPdfUrl;
                if (!currentPdfUrl.startsWith('http://') && !currentPdfUrl.startsWith('https://')) {
                    const cleanPath = currentPdfUrl.startsWith('/') ? currentPdfUrl.substring(1) : currentPdfUrl;
                    fullPdfUrl = `${window.location.origin}/${cleanPath}`;
                }
                
                const sanitizedFilename = currentTitle.replace(/[^a-z0-9]/gi, '-').toLowerCase() + '.pdf';
                
                modalContent.innerHTML = `
                    <iframe 
                        class="pdf-viewer-iframe" 
                        src="${fullPdfUrl}"
                        type="application/pdf"
                        allowfullscreen
                    ></iframe>
                    <div class="pdf-fallback" style="display: none;">
                        <h3>üìÑ PDF Viewer</h3>
                        <p>Unable to display PDF inline.</p>
                        <p>You can download or view the PDF:</p>
                        <a href="#" onclick="downloadPDF('${currentPdfUrl}', '${sanitizedFilename}'); return false;" class="btn btn-primary" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--accent-color); color: white; text-decoration: none; border-radius: 8px; margin: 0.5rem; font-weight: 600;">
                            ‚¨áÔ∏è Download PDF
                        </a>
                        <a href="${fullPdfUrl}" class="btn btn-secondary" target="_blank" style="display: inline-block; padding: 0.75rem 1.5rem; background: #718096; color: white; text-decoration: none; border-radius: 8px; margin: 0.5rem; font-weight: 600;">
                            üëÅÔ∏è Open in New Tab
                        </a>
                    </div>
                `;
            }
            
            // Switch to Book Mode
            async function loadBookMode() {
                currentViewMode = 'book';
                bookViewBtn.classList.add('active');
                normalViewBtn.classList.remove('active');
                
                // Check if PDF.js is available
                if (typeof pdfjsLib === 'undefined') {
                    console.error('[Book Mode] PDF.js library not loaded');
                    modalContent.innerHTML = `
                        <div class="pdf-book-container">
                            <div class="pdf-book-viewer">
                                <div class="pdf-loading" style="color: #ff6b6b;">
                                    <div style="font-size: 3rem;">‚ö†Ô∏è</div>
                                    <div>Book Mode Unavailable</div>
                                    <p style="max-width: 400px; text-align: center; margin: 1rem 0;">
                                        PDF.js library is required for book mode but could not be loaded.
                                        Please try normal view mode instead.
                                    </p>
                                    <button class="pdf-book-btn" onclick="document.getElementById('normalViewBtn').click()">
                                        Switch to Normal View
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                    return;
                }
                
                // Show loading
                modalContent.innerHTML = `
                    <div class="pdf-book-container">
                        <div class="pdf-book-viewer">
                            <div class="pdf-loading">
                                <div class="pdf-loading-spinner"></div>
                                <div>Loading book...</div>
                            </div>
                        </div>
                    </div>
                `;
                
                try {
                    // Ensure URL is absolute
                    let fullPdfUrl = currentPdfUrl;
                    if (!currentPdfUrl.startsWith('http://') && !currentPdfUrl.startsWith('https://')) {
                        const cleanPath = currentPdfUrl.startsWith('/') ? currentPdfUrl.substring(1) : currentPdfUrl;
                        fullPdfUrl = `${window.location.origin}/${cleanPath}`;
                    }
                    
                    console.log('[Book Mode] Loading PDF:', fullPdfUrl);
                    
                    // Load PDF document
                    const loadingTask = pdfjsLib.getDocument(fullPdfUrl);
                    pdfDocument = await loadingTask.promise;
                    totalPages = pdfDocument.numPages;
                    
                    console.log(`[Book Mode] PDF loaded - ${totalPages} pages`);
                    
                    // Initialize book viewer
                    initBookViewer();
                    
                    // Render first page(s)
                    await renderBookPages();
                    
                } catch (error) {
                    console.error('[Book Mode] Error loading PDF:', error);
                    modalContent.innerHTML = `
                        <div class="pdf-book-container">
                            <div class="pdf-book-viewer">
                                <div class="pdf-loading" style="color: #ff6b6b;">
                                    <div style="font-size: 3rem;">‚ö†Ô∏è</div>
                                    <div>Failed to load PDF in book mode</div>
                                    <p style="max-width: 400px; margin: 1rem 0; opacity: 0.8;">${error.message}</p>
                                    <button class="pdf-book-btn" onclick="document.getElementById('normalViewBtn').click()">
                                        Try Normal View
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }
            
            // Initialize book viewer UI
            let currentLayout = 'spread'; // 'spread' or 'single'
            let currentZoom = 1.0;
            
            function initBookViewer() {
                const sanitizedFilename = currentTitle.replace(/[^a-z0-9]/gi, '-').toLowerCase() + '.pdf';
                
                modalContent.innerHTML = `
                    <div class="pdf-book-container">
                        <div class="pdf-book-controls">
                            <div class="pdf-book-nav">
                                <button class="pdf-book-btn btn-icon" id="firstPageBtn" title="First Page">
                                    <span>‚èÆÔ∏è</span>
                                </button>
                                <button class="pdf-book-btn" id="prevPageBtn" title="Previous Page">
                                    <span>‚óÄÔ∏è</span> Prev
                                </button>
                                <span class="pdf-page-info" id="pageInfo">Page 1 of ${totalPages}</span>
                                <button class="pdf-book-btn" id="nextPageBtn" title="Next Page">
                                    Next <span>‚ñ∂Ô∏è</span>
                                </button>
                                <button class="pdf-book-btn btn-icon" id="lastPageBtn" title="Last Page">
                                    <span>‚è≠Ô∏è</span>
                                </button>
                            </div>
                            
                            <div class="pdf-book-nav">
                                <div class="pdf-page-jump">
                                    <input type="number" id="pageJumpInput" min="1" max="${totalPages}" value="1" title="Jump to page">
                                    <button class="pdf-book-btn btn-icon" id="pageJumpBtn" title="Go to page">
                                        <span>‚Üµ</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="pdf-book-nav">
                                <div class="pdf-layout-toggle">
                                    <button class="pdf-layout-btn active" id="spreadLayoutBtn" title="Two-page spread">
                                        üìñ Spread
                                    </button>
                                    <button class="pdf-layout-btn" id="singleLayoutBtn" title="Single page">
                                        üìÑ Single
                                    </button>
                                </div>
                            </div>
                            
                            <div class="pdf-book-nav">
                                <div class="pdf-zoom-controls">
                                    <button class="pdf-book-btn btn-icon" id="zoomOutBtn" title="Zoom out">
                                        <span>‚àí</span>
                                    </button>
                                    <span class="pdf-zoom-level" id="zoomLevel">100%</span>
                                    <button class="pdf-book-btn btn-icon" id="zoomInBtn" title="Zoom in">
                                        <span>+</span>
                                    </button>
                                    <button class="pdf-book-btn btn-icon" id="zoomResetBtn" title="Reset zoom">
                                        <span>‚äô</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="pdf-book-nav">
                                <button class="pdf-book-btn" onclick="downloadPDF('${currentPdfUrl}', '${sanitizedFilename}')" title="Download PDF">
                                    ‚¨áÔ∏è <span>Download</span>
                                </button>
                            </div>
                        </div>
                        <div class="pdf-book-viewer" id="bookViewer">
                            <div class="pdf-book-spread" id="bookSpread">
                                <!-- Pages will be rendered here -->
                            </div>
                        </div>
                    </div>
                `;
                
                // Attach event listeners
                document.getElementById('firstPageBtn').addEventListener('click', () => goToPage(1));
                document.getElementById('prevPageBtn').addEventListener('click', previousPage);
                document.getElementById('nextPageBtn').addEventListener('click', nextPage);
                document.getElementById('lastPageBtn').addEventListener('click', () => goToPage(totalPages));
                
                // Page jump functionality
                const pageJumpInput = document.getElementById('pageJumpInput');
                const pageJumpBtn = document.getElementById('pageJumpBtn');
                
                pageJumpBtn.addEventListener('click', () => {
                    const targetPage = parseInt(pageJumpInput.value);
                    if (targetPage >= 1 && targetPage <= totalPages) {
                        goToPage(targetPage);
                    }
                });
                
                pageJumpInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        pageJumpBtn.click();
                    }
                });
                
                // Layout toggle
                document.getElementById('spreadLayoutBtn').addEventListener('click', () => {
                    currentLayout = 'spread';
                    document.getElementById('spreadLayoutBtn').classList.add('active');
                    document.getElementById('singleLayoutBtn').classList.remove('active');
                    renderBookPages();
                });
                
                document.getElementById('singleLayoutBtn').addEventListener('click', () => {
                    currentLayout = 'single';
                    document.getElementById('singleLayoutBtn').classList.add('active');
                    document.getElementById('spreadLayoutBtn').classList.remove('active');
                    renderBookPages();
                });
                
                // Zoom controls
                document.getElementById('zoomInBtn').addEventListener('click', () => {
                    currentZoom = Math.min(currentZoom + 0.25, 3.0);
                    updateZoom();
                });
                
                document.getElementById('zoomOutBtn').addEventListener('click', () => {
                    currentZoom = Math.max(currentZoom - 0.25, 0.5);
                    updateZoom();
                });
                
                document.getElementById('zoomResetBtn').addEventListener('click', () => {
                    currentZoom = 1.0;
                    updateZoom();
                });
            }
            
            // Update zoom level
            function updateZoom() {
                const spread = document.getElementById('bookSpread');
                const zoomLevel = document.getElementById('zoomLevel');
                
                if (spread) {
                    spread.style.transform = `scale(${currentZoom})`;
                }
                
                if (zoomLevel) {
                    zoomLevel.textContent = `${Math.round(currentZoom * 100)}%`;
                }
            }
            
            // Render book pages
            async function renderBookPages() {
                const spread = document.getElementById('bookSpread');
                const pageInfo = document.getElementById('pageInfo');
                const pageJumpInput = document.getElementById('pageJumpInput');
                
                if (!spread) return;
                
                // Update spread class
                if (currentLayout === 'single') {
                    spread.classList.add('single-page');
                } else {
                    spread.classList.remove('single-page');
                }
                
                // Clear previous pages
                spread.innerHTML = '<div class="pdf-loading"><div class="pdf-loading-spinner"></div></div>';
                
                try {
                    const pages = [];
                    
                    if (currentLayout === 'single') {
                        // Single page mode
                        if (currentPage <= totalPages) {
                            pages.push(renderPage(currentPage, 'single'));
                        }
                    } else {
                        // Spread mode (two pages)
                        const leftPage = currentPage;
                        const rightPage = currentPage + 1;
                        
                        // Load left page
                        if (leftPage <= totalPages) {
                            pages.push(renderPage(leftPage, 'left'));
                        }
                        
                        // Load right page
                        if (rightPage <= totalPages) {
                            pages.push(renderPage(rightPage, 'right'));
                        }
                    }
                    
                    const renderedPages = await Promise.all(pages);
                    
                    // Clear loading and add pages
                    spread.innerHTML = '';
                    renderedPages.forEach(pageElement => {
                        if (pageElement) spread.appendChild(pageElement);
                    });
                    
                    // Update page info
                    const displayPage = Math.min(currentPage, totalPages);
                    const endPage = currentLayout === 'single' ? displayPage : Math.min(currentPage + 1, totalPages);
                    const pageText = currentLayout === 'single' || currentPage >= totalPages 
                        ? `Page ${displayPage} of ${totalPages}`
                        : `Pages ${displayPage}-${endPage} of ${totalPages}`;
                    
                    pageInfo.textContent = pageText;
                    
                    if (pageJumpInput) {
                        pageJumpInput.value = displayPage;
                    }
                    
                    // Update button states
                    const isFirstPage = currentPage === 1;
                    const isLastPage = currentLayout === 'single' 
                        ? currentPage >= totalPages 
                        : currentPage >= totalPages - 1;
                    
                    document.getElementById('firstPageBtn').disabled = isFirstPage;
                    document.getElementById('prevPageBtn').disabled = isFirstPage;
                    document.getElementById('nextPageBtn').disabled = isLastPage;
                    document.getElementById('lastPageBtn').disabled = isLastPage;
                    
                } catch (error) {
                    console.error('[Book Mode] Error rendering pages:', error);
                    spread.innerHTML = '<div class="pdf-loading" style="color: #ff6b6b;"><div>Error rendering pages</div></div>';
                }
            }
            
            // Render a single page
            async function renderPage(pageNumber, side) {
                if (pageNumber > totalPages) return null;
                
                try {
                    const page = await pdfDocument.getPage(pageNumber);
                    
                    // Calculate viewport scale
                    const viewport = page.getViewport({ scale: 1.0 });
                    const container = document.getElementById('bookViewer');
                    
                    // Calculate scale based on container size
                    let scale = 1.5; // Default scale
                    if (container) {
                        const containerHeight = container.offsetHeight - 100;
                        const containerWidth = container.offsetWidth - 100;
                        
                        // Calculate scale to fit height
                        const scaleHeight = containerHeight / viewport.height;
                        
                        // Calculate scale to fit width (accounting for layout)
                        const maxWidth = currentLayout === 'single' 
                            ? containerWidth 
                            : (containerWidth - 40) / 2; // Subtract gap
                        const scaleWidth = maxWidth / viewport.width;
                        
                        // Use the smaller scale to ensure it fits
                        scale = Math.min(scaleHeight, scaleWidth) * 0.95; // 95% to add some padding
                    }
                    
                    // Use high DPI scaling for crisp rendering
                    const outputScale = window.devicePixelRatio || 1;
                    const renderScale = scale * 2; // 2x for high quality rendering
                    const scaledViewport = page.getViewport({ scale: renderScale });
                    
                    // Create canvas with high resolution
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d', { alpha: false });
                    
                    // Set canvas size for high DPI
                    canvas.height = scaledViewport.height;
                    canvas.width = scaledViewport.width;
                    
                    // Set display size (CSS size will be scaled down)
                    canvas.style.width = `${scaledViewport.width / 2}px`;
                    canvas.style.height = `${scaledViewport.height / 2}px`;
                    
                    // Enable image smoothing for better quality
                    context.imageSmoothingEnabled = true;
                    context.imageSmoothingQuality = 'high';
                    
                    // Render page at high resolution
                    await page.render({
                        canvasContext: context,
                        viewport: scaledViewport,
                        intent: 'print' // Use print quality rendering
                    }).promise;
                    
                    // Create page container
                    const pageDiv = document.createElement('div');
                    pageDiv.className = `pdf-book-page pdf-book-page-${side}`;
                    pageDiv.appendChild(canvas);
                    
                    // Add page number indicator
                    const pageLabel = document.createElement('div');
                    pageLabel.style.cssText = `
                        position: absolute;
                        bottom: 10px;
                        ${side === 'left' ? 'right: 10px;' : 'left: 10px;'}
                        color: #666;
                        font-size: 12px;
                        font-weight: 600;
                        background: rgba(255, 255, 255, 0.9);
                        padding: 4px 8px;
                        border-radius: 4px;
                    `;
                    pageLabel.textContent = pageNumber;
                    pageDiv.appendChild(pageLabel);
                    
                    return pageDiv;
                    
                } catch (error) {
                    console.error(`[Book Mode] Error rendering page ${pageNumber}:`, error);
                    return null;
                }
            }
            
            // Navigation functions
            function nextPage() {
                const increment = currentLayout === 'single' ? 1 : 2;
                if (currentPage + increment <= totalPages) {
                    // Add animation class
                    const pages = document.querySelectorAll('.pdf-book-page');
                    pages.forEach((page, index) => {
                        if (currentLayout === 'single') {
                            page.classList.add('turning-next-right');
                        } else {
                            page.classList.add(index === 0 ? 'turning-next-left' : 'turning-next-right');
                        }
                    });
                    
                    setTimeout(() => {
                        currentPage += increment;
                        renderBookPages();
                    }, 300);
                } else if (currentPage < totalPages) {
                    // Handle last page in spread mode
                    currentPage = totalPages;
                    renderBookPages();
                }
            }
            
            function previousPage() {
                const decrement = currentLayout === 'single' ? 1 : 2;
                if (currentPage > 1) {
                    // Add animation class
                    const pages = document.querySelectorAll('.pdf-book-page');
                    pages.forEach((page, index) => {
                        if (currentLayout === 'single') {
                            page.classList.add('turning-prev-left');
                        } else {
                            page.classList.add(index === 0 ? 'turning-prev-left' : 'turning-prev-right');
                        }
                    });
                    
                    setTimeout(() => {
                        currentPage = Math.max(1, currentPage - decrement);
                        renderBookPages();
                    }, 300);
                }
            }
            
            function goToPage(page) {
                if (page >= 1 && page <= totalPages && page !== currentPage) {
                    currentPage = page;
                    // In spread mode, ensure we're on an odd page for proper alignment
                    if (currentLayout === 'spread' && currentPage % 2 === 0 && currentPage > 1) {
                        currentPage -= 1;
                    }
                    renderBookPages();
                }
            }
            
            // View mode toggle handlers
            normalViewBtn.addEventListener('click', loadNormalView);
            bookViewBtn.addEventListener('click', loadBookMode);
            
            // Close handlers
            closeBtn.addEventListener('click', window.closePDFViewer);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    window.closePDFViewer();
                }
            });
            
            document.addEventListener('keydown', function(e) {
                if (!modal.classList.contains('active')) return;
                
                if (e.key === 'Escape') {
                    window.closePDFViewer();
                } else if (currentViewMode === 'book') {
                    // Prevent default for navigation keys
                    if (['ArrowRight', 'ArrowLeft', 'PageDown', 'PageUp', 'Home', 'End'].includes(e.key)) {
                        e.preventDefault();
                    }
                    
                    if (e.key === 'ArrowRight' || e.key === 'PageDown' || e.key === ' ') {
                        e.preventDefault();
                        nextPage();
                    } else if (e.key === 'ArrowLeft' || e.key === 'PageUp') {
                        e.preventDefault();
                        previousPage();
                    } else if (e.key === 'Home') {
                        e.preventDefault();
                        goToPage(1);
                    } else if (e.key === 'End') {
                        e.preventDefault();
                        goToPage(totalPages);
                    } else if (e.key === '+' || e.key === '=') {
                        // Zoom in
                        e.preventDefault();
                        const zoomInBtn = document.getElementById('zoomInBtn');
                        if (zoomInBtn) zoomInBtn.click();
                    } else if (e.key === '-' || e.key === '_') {
                        // Zoom out
                        e.preventDefault();
                        const zoomOutBtn = document.getElementById('zoomOutBtn');
                        if (zoomOutBtn) zoomOutBtn.click();
                    } else if (e.key === '0') {
                        // Reset zoom
                        e.preventDefault();
                        const zoomResetBtn = document.getElementById('zoomResetBtn');
                        if (zoomResetBtn) zoomResetBtn.click();
                    } else if (e.key === 's' || e.key === 'S') {
                        // Toggle single/spread
                        e.preventDefault();
                        if (currentLayout === 'spread') {
                            document.getElementById('singleLayoutBtn')?.click();
                        } else {
                            document.getElementById('spreadLayoutBtn')?.click();
                        }
                    }
                }
            });
        }
        
        // Function to generate PDF thumbnail from first page
        async function generatePDFThumbnail(pdfUrl, containerId) {
            try {
                console.log(`[PDF Thumbnail] Generating thumbnail for: ${pdfUrl}`);
                
                // Get the container element
                const container = document.getElementById(containerId);
                if (!container) {
                    console.error(`[PDF Thumbnail] Container not found: ${containerId}`);
                    return;
                }
                
                // Show loading indicator
                container.innerHTML = '<div class="loading-indicator">‚è≥</div>';
                
                // Ensure URL is absolute
                let fullPdfUrl = pdfUrl;
                if (!pdfUrl.startsWith('http://') && !pdfUrl.startsWith('https://')) {
                    const cleanPath = pdfUrl.startsWith('/') ? pdfUrl.substring(1) : pdfUrl;
                    fullPdfUrl = `${window.location.origin}/${cleanPath}`;
                }
                
                // Load PDF
                const loadingTask = pdfjsLib.getDocument(fullPdfUrl);
                const pdf = await loadingTask.promise;
                
                console.log(`[PDF Thumbnail] PDF loaded, pages: ${pdf.numPages}`);
                
                // Get first page
                const page = await pdf.getPage(1);
                
                // Calculate scale to fit container with high quality
                const viewport = page.getViewport({ scale: 1.0 });
                const containerWidth = container.offsetWidth || 300;
                const baseScale = containerWidth / viewport.width;
                
                // Use 3x scale for crisp thumbnails
                const renderScale = baseScale * 3;
                const scaledViewport = page.getViewport({ scale: renderScale });
                
                // Create canvas with high resolution
                const canvas = document.createElement('canvas');
                canvas.className = 'pdf-thumbnail';
                const context = canvas.getContext('2d', { alpha: false });
                
                // Set canvas internal resolution
                canvas.height = scaledViewport.height;
                canvas.width = scaledViewport.width;
                
                // Set display size (CSS)
                canvas.style.width = '100%';
                canvas.style.height = '100%';
                canvas.style.objectFit = 'cover';
                
                // Enable high quality rendering
                context.imageSmoothingEnabled = true;
                context.imageSmoothingQuality = 'high';
                
                // Render PDF page to canvas
                const renderContext = {
                    canvasContext: context,
                    viewport: scaledViewport,
                    intent: 'print' // Use print quality
                };
                
                await page.render(renderContext).promise;
                
                // Replace loading indicator with canvas
                container.innerHTML = '';
                container.appendChild(canvas);
                
                console.log(`[PDF Thumbnail] ‚úì Thumbnail generated successfully at ${renderScale}x scale`);
                
            } catch (error) {
                console.error('[PDF Thumbnail] Error generating thumbnail:', error);
                // Keep the fallback emoji
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = 'üìñ';
                }
            }
        }
        
        // Load magazine releases from static folder
        async function loadMagazineReleases() {
            const releasesGrid = document.getElementById('releasesGrid');
            
            if (!releasesGrid) return;
            
            try {
                console.log('[Magazine] Loading magazine releases...');
                
                // List of PDF files in the releases folder
                // Since we can't dynamically list files from a static folder in browser,
                // we'll try to load a manifest file or use a predefined list
                const releases = await fetchMagazineReleases();
                
                if (releases.length === 0) {
                    releasesGrid.innerHTML = `
                        <div class="empty-releases" style="grid-column: 1/-1;">
                            <div class="empty-releases-icon">üìö</div>
                            <h3 data-en="No Releases Yet" data-ar="ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ•ÿµÿØÿßÿ±ÿßÿ™ ÿ®ÿπÿØ">No Releases Yet</h3>
                            <p data-en="Check back soon for our magazine releases!" data-ar="ÿ™ÿ≠ŸÇŸÇ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ ŸÇÿ±Ÿäÿ®ÿßŸã ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ•ÿµÿØÿßÿ±ÿßÿ™ ŸÖÿ¨ŸÑÿ™ŸÜÿß!">Check back soon for our magazine releases!</p>
                        </div>
                    `;
                    console.log('[Magazine] No releases found');
                    return;
                }
                
                console.log(`[Magazine] Found ${releases.length} release(s)`);
                
                // Display releases
                releasesGrid.innerHTML = releases.map((release, index) => {
                    // Sanitize filename for download
                    const downloadFilename = release.filename || (release.title.replace(/[^a-z0-9]/gi, '-').toLowerCase() + '.pdf');
                    
                    return `
                    <div class="release-card reveal">
                        <div class="release-preview" id="pdf-preview-${index}">
                            üìñ
                        </div>
                        <div class="release-info">
                            <h3 class="release-title">${release.title}</h3>
                            <div class="release-date">üìÖ ${release.date}</div>
                            <div class="release-actions">
                                <a href="#" onclick="openPDFViewer('${release.url}', '${release.title.replace(/'/g, "\\'")}'); return false;" class="release-btn btn-view">
                                    üëÅÔ∏è View
                                </a>
                                <a href="#" onclick="downloadPDF('${release.url}', '${downloadFilename}'); return false;" class="release-btn btn-download">
                                    ‚¨áÔ∏è Download
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                }).join('');
                
                // Generate thumbnails for each release
                releases.forEach((release, index) => {
                    // Use setTimeout to avoid blocking the UI
                    setTimeout(() => {
                        generatePDFThumbnail(release.url, `pdf-preview-${index}`);
                    }, index * 100); // Stagger the thumbnail generation
                });
                
            } catch (error) {
                console.error('[Magazine] Error loading releases:', error);
                releasesGrid.innerHTML = `
                    <div class="empty-releases" style="grid-column: 1/-1;">
                        <div class="empty-releases-icon">üìö</div>
                        <h3 data-en="No Releases Yet" data-ar="ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ•ÿµÿØÿßÿ±ÿßÿ™ ÿ®ÿπÿØ">No Releases Yet</h3>
                        <p data-en="Check back soon for our magazine releases!" data-ar="ÿ™ÿ≠ŸÇŸÇ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ ŸÇÿ±Ÿäÿ®ÿßŸã ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ•ÿµÿØÿßÿ±ÿßÿ™ ŸÖÿ¨ŸÑÿ™ŸÜÿß!">Check back soon for our magazine releases!</p>
                    </div>
                `;
            }
        }
        
        // Fetch magazine releases
        async function fetchMagazineReleases() {
            // Try to fetch manifest file
            try {
                const response = await fetch(`${RELEASES_FOLDER}manifest.json`);
                if (response.ok) {
                    const data = await response.json();
                    return data.releases || [];
                }
            } catch (e) {
                console.log('[Magazine] No manifest file found, checking for individual files');
            }
            
            // If no manifest, try common filenames
            const commonFiles = [
                'issue-01.pdf',
                'issue-02.pdf',
                'issue-03.pdf',
                'volume-1-issue-1.pdf',
                'spring-2025.pdf',
                'fall-2024.pdf',
                'winter-2024.pdf'
            ];
            
            const releases = [];
            
            for (const filename of commonFiles) {
                try {
                    const url = `${RELEASES_FOLDER}${filename}`;
                    const response = await fetch(url, { method: 'HEAD' });
                    if (response.ok) {
                        // Extract title from filename
                        const title = filename
                            .replace('.pdf', '')
                            .split('-')
                            .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                            .join(' ');
                        
                        releases.push({
                            title: title,
                            url: url,
                            date: 'Release Date',
                            filename: filename
                        });
                    }
                } catch (e) {
                    // File doesn't exist, continue
                }
            }
            
            return releases;
        }

        // Function to create article card HTML
        async function createArticleCard(article, index, categoryOverride = null) {
            const dateInfo = dataLoader.formatDate(article.date);
            
            // Skip articles with invalid dates
            if (!dateInfo) {
                console.warn('[Magazine] Skipping article with invalid date:', article.title);
                return '';
            }
            
            // Load categories from JSON configuration
            const categories = await categoriesLoader.getMagazineCategories();
            const category = categoryOverride || categories[index % categories.length];
            const icons = ['üìê', 'üåø', 'üíª', 'üèõÔ∏è', 'üé®', 'üë•'];
            const icon = icons[index % icons.length];
            
            return `
                <div class="article-card reveal">
                    <div class="article-image" style="${article.imageUrl ? `background-image: url('${article.imageUrl}'); background-size: cover; background-position: center;` : ''}">
                        ${article.imageUrl ? '' : icon}
                        
                    </div>
                    <div class="article-content">
                        <div class="article-meta">
                            <span>üìÖ ${dateInfo.month} ${dateInfo.day}, ${dateInfo.year}</span>
                            <span>‚è±Ô∏è ${Math.floor(Math.random() * 5) + 3} min read</span>
                        </div>
                        <h3 class="article-title">${article.title}</h3>
                        <p class="article-excerpt">
                            ${article.summary}
                        </p>
                        ${article.readMoreUrl ? 
                            `<a href="${article.readMoreUrl}" class="read-more" target="_blank" rel="noopener noreferrer">Read More ‚Üí</a>` : 
                            `<a href="articles.html?id=${article.id}" class="read-more">Read More ‚Üí</a>`
                        }
                    </div>
                </div>
            `;
        }

        // Load magazine data from Firebase using Data Loader
        async function loadMagazine() {
            const featuredContent = document.getElementById('featuredContent');
            const latestArticles = document.getElementById('latestArticles');
            const designArticles = document.getElementById('designArticles');
            const communityArticles = document.getElementById('communityArticles');
            const allArticles = document.getElementById('allArticles');
            
            // Show loading state for all grids
            const loadingHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">‚è≥</div>
                    <p style="color: var(--text-secondary);">Loading articles...</p>
                </div>
            `;
            
            if (featuredContent) {
                featuredContent.innerHTML = loadingHTML;
            }
            [latestArticles, designArticles, communityArticles, allArticles].forEach(grid => {
                if (grid) grid.innerHTML = loadingHTML;
            });
            
            try {
                console.log('[Magazine] Loading magazine using Data Loader...');
                
                // Use Data Loader to fetch magazine
                const result = await dataLoader.getMagazine();
                
                if (!result.success) {
                    throw new Error(result.error || 'Failed to load magazine');
                }
                
                const magazineData = result.magazine;
                const articlesCount = magazineData?.articles?.length || 0;
                const hasFeatured = !!magazineData?.featuredArticle;
                console.log(`[Magazine] ‚úì Magazine content loaded - Articles: ${articlesCount}, Has Featured: ${hasFeatured}`);
                
                // Always log fetched magazine data for debugging
                if (magazineData?.featuredArticle) {
                    console.log('[Magazine] Featured article:', {
                        title: magazineData.featuredArticle.title,
                        author: magazineData.featuredArticle.author,
                        date: magazineData.featuredArticle.date
                    });
                }
                if (articlesCount > 0) {
                    console.log('[Magazine] Article list:');
                    magazineData.articles.forEach((article, index) => {
                        console.log(`  Article ${index + 1}:`, {
                            id: article.id,
                            title: article.title,
                            author: article.author,
                            date: article.date
                        });
                    });
                }
                
                // Additional debug logging
                if (DEBUG) {
                    console.log('[Magazine] Debug mode enabled - Full magazine details');
                    if (magazineData?.featuredArticle) {
                        console.log('[Magazine] Featured article full data:', magazineData.featuredArticle);
                    }
                }
                
                if (magazineData) {
                    // Load featured article
                    if (magazineData.featuredArticle && featuredContent) {
                        const featured = magazineData.featuredArticle;
                        const dateInfo = dataLoader.formatDate(featured.date);
                        
                        // Only show if date is valid
                        if (dateInfo) {
                            featuredContent.innerHTML = `
                                <div class="featured-image reveal" style="${featured.imageUrl ? `background-image: url('${featured.imageUrl}'); background-size: cover; background-position: center;` : ''}">${featured.imageUrl ? '' : (featured.image || 'üèóÔ∏è')}</div>
                                <div class="featured-text reveal">
                                    <div class="article-date">üìÖ ${dateInfo.month} ${dateInfo.year}</div>
                                    <h2>${featured.title}</h2>
                                    <p>${featured.summary}</p>
                                    ${featured.content ? `<p>${featured.content.substring(0, 200)}...</p>` : ''}
                                    ${featured.readMoreUrl ? 
                                        `<a href="${featured.readMoreUrl}" class="btn btn-primary" target="_blank" rel="noopener noreferrer">Read Full Article</a>` : 
                                        `<a href="articles.html?id=${featured.id}" class="btn btn-primary">Read Full Article</a>`
                                    }
                                </div>
                            `;
                        } else {
                            console.warn('[Magazine] Featured article has invalid date');
                            featuredContent.innerHTML = `
                                <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                                    <div style="font-size: 4rem; margin-bottom: 1rem;">üì∞</div>
                                    <h3 style="color: var(--primary-color); margin-bottom: 0.5rem;">No Featured Article</h3>
                                    <p style="color: var(--text-secondary);">Check back soon for our featured content!</p>
                                </div>
                            `;
                        }
                    } else if (featuredContent) {
                        featuredContent.innerHTML = `
                            <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                                <div style="font-size: 4rem; margin-bottom: 1rem;">üì∞</div>
                                <h3 style="color: var(--primary-color); margin-bottom: 0.5rem;">No Featured Article</h3>
                                <p style="color: var(--text-secondary);">Check back soon for our featured content!</p>
                            </div>
                        `;
                    }
                    
                    // Process all articles
                    if (magazineData.articles && magazineData.articles.length > 0) {
                        const allArticlesList = [...magazineData.articles];
                        
                        // Latest Articles (first 3)
                        if (latestArticles) {
                            const latest = allArticlesList.slice(0, 3);
                            if (latest.length > 0) {
                                const cards = await Promise.all(latest.map((article, index) => 
                                    createArticleCard(article, index)
                                ));
                                latestArticles.innerHTML = cards.join('');
                            } else {
                                latestArticles.innerHTML = `
                                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                                        <p style="color: var(--text-secondary);">No articles available yet</p>
                                    </div>
                                `;
                            }
                        }
                        
                        // Design Articles (articles 3-6 or with Design category)
                        if (designArticles) {
                            const design = allArticlesList.slice(3, 6);
                            if (design.length > 0) {
                                const cards = await Promise.all(design.map((article, index) => 
                                    createArticleCard(article, index, 'Design')
                                ));
                                designArticles.innerHTML = cards.join('');
                            } else {
                                designArticles.innerHTML = `
                                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                                        <p style="color: var(--text-secondary);">No design articles available yet</p>
                                    </div>
                                `;
                            }
                        }
                        
                        // Community Articles (articles 6-9 or with Community category)
                        if (communityArticles) {
                            const community = allArticlesList.slice(6, 9);
                            if (community.length > 0) {
                                const cards = await Promise.all(community.map((article, index) => 
                                    createArticleCard(article, index, 'Community')
                                ));
                                communityArticles.innerHTML = cards.join('');
                            } else {
                                communityArticles.innerHTML = `
                                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                                        <p style="color: var(--text-secondary);">No community articles available yet</p>
                                    </div>
                                `;
                            }
                        }
                        
                        // All Articles
                        if (allArticles) {
                            if (allArticlesList.length > 0) {
                                const cards = await Promise.all(allArticlesList.map((article, index) => 
                                    createArticleCard(article, index)
                                ));
                                allArticles.innerHTML = cards.join('');
                            } else {
                                allArticles.innerHTML = `
                                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                                        <div style="font-size: 4rem; margin-bottom: 1rem;">üìÑ</div>
                                        <h3 style="color: var(--primary-color); margin-bottom: 0.5rem;">No Articles Available</h3>
                                        <p style="color: var(--text-secondary);">New articles coming soon!</p>
                                    </div>
                                `;
                            }
                        }
                    } else {
                        // Show empty state for all grids
                        const emptyHTML = `
                            <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                                <div style="font-size: 4rem; margin-bottom: 1rem;">üìÑ</div>
                                <h3 style="color: var(--primary-color); margin-bottom: 0.5rem;">No Articles Available</h3>
                                <p style="color: var(--text-secondary);">New articles coming soon!</p>
                            </div>
                        `;
                        [latestArticles, designArticles, communityArticles, allArticles].forEach(grid => {
                            if (grid) grid.innerHTML = emptyHTML;
                        });
                    }
                } else {
                    // Show empty state for all containers
                    const emptyHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                            <div style="font-size: 4rem; margin-bottom: 1rem;">üì∞</div>
                            <h3 style="color: var(--primary-color); margin-bottom: 0.5rem;">No Content Available</h3>
                            <p style="color: var(--text-secondary);">Magazine content is being prepared. Check back soon!</p>
                        </div>
                    `;
                    if (featuredContent) featuredContent.innerHTML = emptyHTML;
                    [latestArticles, designArticles, communityArticles, allArticles].forEach(grid => {
                        if (grid) grid.innerHTML = emptyHTML;
                    });
                }
            } catch (error) {
                console.error('[Magazine] ‚úó Error loading magazine:', error);
                // Show error state
                const errorHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
                        <h3 style="color: var(--primary-color); margin-bottom: 0.5rem;">Unable to Load Articles</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 1rem;">There was a problem loading the content. Please try again.</p>
                        <button class="btn btn-primary" onclick="location.reload()">Retry</button>
                    </div>
                `;
                if (featuredContent) featuredContent.innerHTML = errorHTML;
                [latestArticles, designArticles, communityArticles, allArticles].forEach(grid => {
                    if (grid) grid.innerHTML = errorHTML;
                });
            }
        }
        
        // Initialize view toggle functionality
        function initViewToggle() {
            const viewButtons = document.querySelectorAll('.view-btn');
            
            viewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const viewType = this.getAttribute('data-view');
                    const targetId = this.getAttribute('data-target');
                    const targetGrid = document.getElementById(targetId);
                    
                    if (!targetGrid) return;
                    
                    // Remove all view classes
                    targetGrid.classList.remove('view-grid', 'view-list', 'view-compact', 'view-large');
                    
                    // Add selected view class
                    targetGrid.classList.add(`view-${viewType}`);
                    
                    // Update active state for buttons in this group
                    const siblingButtons = this.parentElement.querySelectorAll('.view-btn');
                    siblingButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Save preference to localStorage
                    localStorage.setItem(`view-${targetId}`, viewType);
                    
                    console.log(`[Magazine] View changed to ${viewType} for ${targetId}`);
                });
            });
            
            // Restore saved view preferences
            const grids = ['latestArticles', 'designArticles', 'communityArticles', 'allArticles'];
            grids.forEach(gridId => {
                const savedView = localStorage.getItem(`view-${gridId}`);
                if (savedView) {
                    const grid = document.getElementById(gridId);
                    const button = document.querySelector(`.view-btn[data-view="${savedView}"][data-target="${gridId}"]`);
                    
                    if (grid && button) {
                        grid.classList.remove('view-grid', 'view-list', 'view-compact', 'view-large');
                        grid.classList.add(`view-${savedView}`);
                        
                        const siblingButtons = button.parentElement.querySelectorAll('.view-btn');
                        siblingButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                    }
                }
            });
        }
        
        // Helper function to download PDF
        window.downloadPDF = function(url, filename) {
            console.log('[PDF Download] Downloading:', url);
            
            try {
                // Ensure URL is properly formatted
                let downloadUrl = url;
                if (!url.startsWith('http://') && !url.startsWith('https://') && !url.startsWith('blob:')) {
                    // Remove leading slash if present to avoid double slash
                    const cleanPath = url.startsWith('/') ? url.substring(1) : url;
                    downloadUrl = `${window.location.origin}/${cleanPath}`;
                }
                
                console.log('[PDF Download] Download URL:', downloadUrl);
                
                // Create a temporary link element
                const link = document.createElement('a');
                link.href = downloadUrl;
                link.download = filename || 'magazine.pdf';
                link.style.display = 'none';
                link.target = '_blank';  // Fallback if download attribute is not supported
                
                // Append to body, click, and remove
                document.body.appendChild(link);
                link.click();
                
                // Clean up after a short delay
                setTimeout(() => {
                    document.body.removeChild(link);
                }, 100);
                
                console.log('[PDF Download] ‚úì Download initiated');
            } catch (error) {
                console.error('[PDF Download] ‚úó Error downloading PDF:', error);
                // Fallback: open in new tab
                window.open(url, '_blank');
            }
        };
        
        // Load magazine when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initPDFModal();
            loadMagazineReleases();
            loadMagazine();
            initViewToggle();
        });
    </script>
</body>
</html>
